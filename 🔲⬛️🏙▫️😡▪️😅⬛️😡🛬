local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

local RANOX = {}

function RANOX:CreateWindow(config)
	local ScreenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
	ScreenGui.Name = "RANOX_UI"
	ScreenGui.ResetOnSpawn = false

	local MainFrame = Instance.new("Frame", ScreenGui)
	MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
	MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
	MainFrame.Size = UDim2.new(0, 500, 0, 420)
	MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
	MainFrame.BorderSizePixel = 0
	MainFrame.ClipsDescendants = true
	MainFrame.Active = true
	MainFrame.Draggable = true

	local UICorner = Instance.new("UICorner", MainFrame)
	UICorner.CornerRadius = UDim.new(0, 8)

	local Gradient = Instance.new("UIGradient", MainFrame)
	Gradient.Color = ColorSequence.new({
		ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 0)),
		ColorSequenceKeypoint.new(0.5, Color3.fromRGB(0, 255, 0)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 0, 255))
	})
	Gradient.Rotation = 45

	local TitleBar = Instance.new("Frame", MainFrame)
	TitleBar.Size = UDim2.new(1, 0, 0, 40)
	TitleBar.BackgroundTransparency = 1

	local Title = Instance.new("TextLabel", TitleBar)
	Title.Size = UDim2.new(1, -40, 1, 0)
	Title.Position = UDim2.new(0, 10, 0, 0)
	Title.Text = config.Title or "RANOX"
	Title.Font = Enum.Font.GothamBold
	Title.TextSize = 20
	Title.TextColor3 = Color3.fromRGB(255, 255, 255)
	Title.BackgroundTransparency = 1
	Title.TextXAlignment = Enum.TextXAlignment.Left

	local SearchBox = Instance.new("TextBox", TitleBar)
	SearchBox.Size = UDim2.new(0, 120, 0, 24)
	SearchBox.Position = UDim2.new(1, -160, 0.5, -12)
	SearchBox.PlaceholderText = "Pesquisar..."
	SearchBox.Font = Enum.Font.Gotham
	SearchBox.TextSize = 14
	SearchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
	SearchBox.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
	SearchBox.BorderSizePixel = 0
	local SearchUICorner = Instance.new("UICorner", SearchBox)
	SearchUICorner.CornerRadius = UDim.new(0, 6)

	local HideButton = Instance.new("TextButton", TitleBar)
	HideButton.Size = UDim2.new(0, 24, 0, 24)
	HideButton.Position = UDim2.new(1, -30, 0.5, -12)
	HideButton.Text = "-"
	HideButton.Font = Enum.Font.GothamBold
	HideButton.TextSize = 18
	HideButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	HideButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
	HideButton.BorderSizePixel = 0
	local HideCorner = Instance.new("UICorner", HideButton)
	HideCorner.CornerRadius = UDim.new(1, 0)

	local TabsHolder = Instance.new("Frame", MainFrame)
	TabsHolder.Size = UDim2.new(1, -20, 0, 30)
	TabsHolder.Position = UDim2.new(0, 10, 0, 40)
	TabsHolder.BackgroundTransparency = 1

	local TabList = Instance.new("UIListLayout", TabsHolder)
	TabList.FillDirection = Enum.FillDirection.Horizontal
	TabList.SortOrder = Enum.SortOrder.LayoutOrder
	TabList.Padding = UDim.new(0, 6)

	local Tabs = {}

	local ContentFrame = Instance.new("Frame", MainFrame)
	ContentFrame.Size = UDim2.new(1, -20, 1, -90)
	ContentFrame.Position = UDim2.new(0, 10, 0, 80)
	ContentFrame.BackgroundTransparency = 1
	ContentFrame.BorderSizePixel = 0

	local CurrentMarker

	local function CreateTab(name)
		local TabButton = Instance.new("TextButton", TabsHolder)
		TabButton.Text = name
		TabButton.Font = Enum.Font.GothamBold
		TabButton.TextSize = 14
		TabButton.AutoButtonColor = false
		TabButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
		TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
		TabButton.Size = UDim2.new(0, 0, 1, 0)
		TabButton.BorderSizePixel = 0
		TabButton.ClipsDescendants = true

		local TabPadding = Instance.new("UIPadding", TabButton)
		TabPadding.PaddingLeft = UDim.new(0, 10)
		TabPadding.PaddingRight = UDim.new(0, 10)

		local Corner = Instance.new("UICorner", TabButton)
		Corner.CornerRadius = UDim.new(0, 6)

		local Marker = Instance.new("Frame", TabsHolder)
		Marker.Size = UDim2.new(0, TabButton.TextBounds.X + 20 * 0.7, 0, 2)
		Marker.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
		Marker.BorderSizePixel = 0
		local mCorner = Instance.new("UICorner", Marker)
		mCorner.CornerRadius = UDim.new(1, 0)
		Marker.Visible = false

		TabButton.Size = UDim2.new(0, TabButton.TextBounds.X + 20, 1, 0)

		local TabContent = Instance.new("ScrollingFrame", ContentFrame)
		TabContent.Size = UDim2.new(1, 0, 1, 0)
		TabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
		TabContent.ScrollBarThickness = 4
		TabContent.Visible = false
		TabContent.BackgroundTransparency = 1

		local ListLayout = Instance.new("UIListLayout", TabContent)
		ListLayout.SortOrder = Enum.SortOrder.LayoutOrder
		ListLayout.Padding = UDim.new(0, 6)

		ListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			TabContent.CanvasSize = UDim2.new(0, 0, 0, ListLayout.AbsoluteContentSize.Y + 10)
		end)

		TabButton.MouseButton1Click:Connect(function()
			for _, t in pairs(Tabs) do
				t.Tab.Visible = false
			end
			TabContent.Visible = true
			if CurrentMarker then CurrentMarker.Visible = false end
			Marker.Visible = true
			CurrentMarker = Marker
			TweenService:Create(Marker, TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
				Position = UDim2.new(0, TabButton.Position.X.Offset + 10, 1, -2),
				Size = UDim2.new(0, TabButton.AbsoluteSize.X * 0.7, 0, 2)
			}):Play()
		end)

		if not next(Tabs) then
			TabContent.Visible = true
			Marker.Position = UDim2.new(0, TabButton.Position.X.Offset + 10, 1, -2)
			Marker.Visible = true
			CurrentMarker = Marker
		end

		Tabs[name] = { Tab = TabContent }

		local API = {}

		function API:CreateButton(text, callback)
			local Button = Instance.new("TextButton", TabContent)
			Button.Size = UDim2.new(1, -10, 0, 38)
			Button.Text = text
			Button.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
			Button.Font = Enum.Font.GothamBold
			Button.TextSize = 16
			Button.TextColor3 = Color3.fromRGB(255, 255, 255)
			Button.BorderSizePixel = 0
			local Corner = Instance.new("UICorner", Button)
			Corner.CornerRadius = UDim.new(0, 6)
			Button.MouseButton1Click:Connect(function()
				if callback then callback() end
			end)
			return Button
		end

		function API:CreateLabel(text)
			local Label = Instance.new("TextLabel", TabContent)
			Label.Size = UDim2.new(1, -10, 0, 30)
			Label.Text = text
			Label.BackgroundTransparency = 1
			Label.Font = Enum.Font.Gotham
			Label.TextSize = 14
			Label.TextColor3 = Color3.fromRGB(255, 255, 255)
			Label.TextXAlignment = Enum.TextXAlignment.Left
			return Label
		end

		return API
	end

	local function searchFilter()
		local query = SearchBox.Text:lower()
		for _, t in pairs(Tabs) do
			for _, child in ipairs(t.Tab:GetChildren()) do
				if child:IsA("GuiObject") and child.Name ~= "UIListLayout" then
					child.Visible = (query == "" or string.find((child.Text or ""):lower(), query))
				end
			end
		end
	end

	SearchBox:GetPropertyChangedSignal("Text"):Connect(searchFilter)

	local EnterTween = TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
		Size = UDim2.new(0, 500, 0, 420),
		Position = UDim2.new(0.5, 0, 0.5, 0)
	})
	MainFrame.Size = UDim2.new(0, 0, 0, 0)
	EnterTween:Play()

	local Ball = Instance.new("ImageButton", ScreenGui)
	Ball.Size = UDim2.new(0, 40, 0, 40)
	Ball.Position = UDim2.new(0, 100, 0, 100)
	Ball.BackgroundTransparency = 1
	Ball.Image = "rbxassetid://4483362458"
	Ball.Visible = false

	local dragging, offset
	Ball.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			offset = Vector2.new(input.Position.X - Ball.AbsolutePosition.X, input.Position.Y - Ball.AbsolutePosition.Y)
		end
	end)

	UserInputService.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = false
		end
	end)

	UserInputService.InputChanged:Connect(function(input)
		if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
			Ball.Position = UDim2.new(0, input.Position.X - offset.X, 0, input.Position.Y - offset.Y)
		end
	end)

	HideButton.MouseButton1Click:Connect(function()
		MainFrame.Visible = false
		Ball.Visible = true
	end)

	Ball.MouseButton1Click:Connect(function()
		MainFrame.Visible = true
		Ball.Visible = false
	end)

	return {
		CreateTab = CreateTab
	}
end

return RANOX
