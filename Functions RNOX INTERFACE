local RNOX = {}

function RNOX:CreateMainUI(params)
    local gui = Instance.new("ScreenGui")
    gui.Parent = game.Players.LocalPlayer.PlayerGui
    gui.ResetOnSpawn = false

    local tweenService = game:GetService("TweenService")

    local baseFrame = Instance.new("Frame")
    baseFrame.Size = UDim2.new(0, 0, 0, 0)
    baseFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    baseFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    baseFrame.BackgroundColor3 = params.BackgroundColor or Color3.fromRGB(0, 0, 0)
    baseFrame.BackgroundTransparency = 0.1
    baseFrame.BorderSizePixel = 0
    baseFrame.Visible = false
    baseFrame.Parent = gui

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.1, 0)
    corner.Parent = baseFrame

    local header = Instance.new("TextLabel")
    header.Size = UDim2.new(1, 0, 0.1, 0)
    header.Position = UDim2.new(0, 0, 0, 0)
    header.BackgroundColor3 = params.TituloCor or Color3.fromRGB(25, 25, 25)
    header.BorderSizePixel = 0
    header.Text = params.Titulo or "RNOX Interface"
    header.TextColor3 = params.TituloTextoCor or Color3.fromRGB(255, 255, 255)
    header.Font = Enum.Font.GothamBold
    header.TextSize = 30
    header.Parent = baseFrame

    local tabScrollFrame = Instance.new("ScrollingFrame")
    tabScrollFrame.Size = UDim2.new(0.95, 0, 0.85, 0)
    tabScrollFrame.Position = UDim2.new(0.025, 0, 0.12, 0)
    tabScrollFrame.CanvasSize = UDim2.new(0, 0, 1, 0)
    tabScrollFrame.ScrollBarThickness = 10
    tabScrollFrame.BackgroundColor3 = Color3.fromRGB(17, 17, 17)
    tabScrollFrame.BorderSizePixel = 0
    tabScrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    tabScrollFrame.Parent = baseFrame

    local layout = Instance.new("UIGridLayout")
    layout.CellPadding = UDim2.new(0.02, 0, 0.06, 0)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    layout.VerticalAlignment = Enum.VerticalAlignment.Top
    layout.Parent = tabScrollFrame

    local hideButton = Instance.new("ImageButton")
    hideButton.Size = UDim2.new(0.05, 0, 0.05, 0)
    hideButton.Position = UDim2.new(0.95, -10, 0, 10)
    hideButton.Image = "rbxassetid://6035047409"
    hideButton.BackgroundTransparency = 1
    hideButton.Parent = baseFrame

    local ballButton = Instance.new("ImageButton")
    ballButton.Size = UDim2.new(0.05, 0, 0.1, 0)
    ballButton.AnchorPoint = Vector2.new(0.5, 0.5)
    ballButton.Position = UDim2.new(0.1, 0, 0.9, 0)
    ballButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    ballButton.Image = "rbxassetid://6337069410"
    ballButton.BackgroundTransparency = 0
    ballButton.Visible = false
    ballButton.Active = true
    ballButton.Draggable = true
    ballButton.Parent = gui

    local ballCorner = Instance.new("UICorner")
    ballCorner.CornerRadius = UDim.new(0.5, 0)
    ballCorner.Parent = ballButton

    hideButton.MouseButton1Click:Connect(function()
        local tweenOut = tweenService:Create(
            baseFrame,
            TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut),
            {Size = UDim2.new(0, 0, 0, 0)}
        )
        tweenOut:Play()
        tweenOut.Completed:Connect(function()
            baseFrame.Visible = false
            ballButton.Visible = true
        end)
    end)

    ballButton.MouseButton1Click:Connect(function()
        ballButton.Visible = false
        baseFrame.Size = UDim2.new(0, 0, 0, 0)
        baseFrame.Visible = true
        local tweenIn = tweenService:Create(
            baseFrame,
            TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut),
            {Size = UDim2.new(0.8, 0, 1.1, 0)}
        )
        tweenIn:Play()
    end)

    self.gui = gui
    self.baseFrame = baseFrame
    self.tabScrollFrame = tabScrollFrame
    self.layout = layout
end

function RNOX:AddButton(parent, params)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0.2, 0, 0.1, 0)
    button.Text = params.Nome or "Botão"
    button.BackgroundColor3 = params.Cor or Color3.fromRGB(35, 35, 35)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.Gotham
    button.TextSize = 18
    button.TextWrapped = true
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.1, 0)
    corner.Parent = button
    button.MouseButton1Click:Connect(function()
        local success, err = pcall(function()
            params.Acao()
        end)
        if not success then
            warn("Erro ao executar a função do botão: " .. err)
        end
    end)
    button.Parent = parent
end

function RNOX:AddToggle(parent, params)
    local toggleButton = Instance.new("TextButton")
    toggleButton.Size = UDim2.new(0.2, 0, 0.1, 0)
    toggleButton.Text = params.Nome or "Toggle"
    toggleButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleButton.Font = Enum.Font.GothamBold
    toggleButton.TextSize = 14
    toggleButton.TextWrapped = true
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.1, 0)
    corner.Parent = toggleButton
    local isActive = false
    toggleButton.MouseButton1Click:Connect(function()
        isActive = not isActive
        toggleButton.BackgroundColor3 = isActive and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
        if params.Acao then
            local success, err = pcall(function()
                params.Acao(isActive)
            end)
            if not success then
                warn("Erro no toggle: " .. err)
            end
        end
    end)
    toggleButton.Parent = parent
end

return RNOX
